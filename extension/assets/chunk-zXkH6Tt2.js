(function(){let l=[];chrome.runtime.onMessage.addListener((t,e,r)=>{try{switch(t.type){case"highlight":u(t.selector),r({success:!0});break;case"removeHighlight":i(),r({success:!0});break;case"executeOperations":o(t.operations),r({success:!0});break}}catch(c){r({success:!1,error:c.message})}return!1});function u(t){i();try{document.querySelectorAll(t).forEach(r=>{const c=r;l.push(c),c.style.outline="2px solid #ff0000",c.style.outlineOffset="2px"})}catch(e){console.error("选择器无效:",e)}}function i(){l.forEach(t=>{t.style.outline="",t.style.outlineOffset=""}),l=[]}function o(t){t.forEach(e=>{try{document.querySelectorAll(e.selector).forEach(c=>{const s=c;switch(e.operationType){case"modifyAttribute":e.attributeName&&e.attributeValue!==void 0&&s.setAttribute(e.attributeName,e.attributeValue);break;case"removeAttribute":e.attributeName&&s.removeAttribute(e.attributeName);break;case"removeAllAttributes":for(;s.attributes.length>0;)s.removeAttribute(s.attributes[0].name);break;case"removeDOM":s.remove();break}})}catch(r){console.error("执行操作失败:",r)}})}console.info("contentScript is running");
})()